<h1>cmd 字符串替换</h1>

<blockquote>
<p>@echo&nbsp;off&nbsp;&nbsp;<br />
REM&nbsp;字符串替换&nbsp;&nbsp;<br />
&nbsp;&nbsp;<br />
set&nbsp;str=待替换文本信息XXX&nbsp;&nbsp;<br />
echo&nbsp;对&ldquo;%str%&rdquo;中的&ldquo;XXX&rdquo;进行替换，替换为&ldquo;YYY&rdquo;&nbsp;&nbsp;<br />
&nbsp;&nbsp;<br />
REM&nbsp;替换str中的XXX为YYY&nbsp;&nbsp;<br />
set&nbsp;str2=%str:XXX=YYY%&nbsp;&nbsp;<br />
&nbsp;&nbsp;<br />
echo&nbsp;-&nbsp;&nbsp;<br />
echo&nbsp;替换后为：%str2%&nbsp;&nbsp;<br />
echo&nbsp;-&nbsp;&nbsp;<br />
pause&nbsp;&nbsp;</p>
</blockquote>

<h2>DOS命令（cmd）批处理：替换字符串、截取字符串、扩充字符串、获取字符串长度</h2>

<p>替换字符串，即将某一字符串中的特定字符或字符串替换为给定的字符串。举例说明其功能：<br />
　　=========================================<br />
　　@echo off<br />
　　set aa=伟大的中国！我为你自豪！<br />
　　echo 替换前：%aa%<br />
　　echo 替换后：%aa:中国=中华人民共和国%<br />
　　echo aa = %aa%<br />
　　set &quot;aa=%aa:中国=中华人民共和国%&quot;<br />
　　echo aa = %aa%<br />
　　pause<br />
　　=========================================<br />
　　对于上面的例子有一点说明，对比两个echo aa = �%可以发现，如果要修改变量aa的内容的话，就需要将修改结果&ldquo;�:中国=中华人民共和国%&rdquo;赋值给变量aa。上面的字符串截取也有着同样的特点。</p>

<p><br />
━━━━━━━━━━━━━━━━━━━━━━━━━━<br />
2、截取字符串<br />
━━━━━━━━━━━━━━━━━━━━━━━━━━<br />
截取字符串可以说是字符串处理功能中最常用的一个子功能了，能够实现截取字符串中的特定位置的一个或多个字符。举例说明其基本功能：<br />
　　=========================================<br />
　　@echo off<br />
　　set ifo=abcdefghijklmnopqrstuvwxyz0123456789<br />
　　echo 原字符串（第二行为各字符的序号）：<br />
　　echo %ifo%<br />
　　echo 123456789012345678901234567890123456<br />
　　echo 截取前5个字符：<br />
　　echo %ifo:~0,5%<br />
　　echo 截取最后5个字符：<br />
　　echo %ifo:~-5%<br />
　　echo 截取第一个到倒数第6个字符：<br />
　　echo %ifo:~0,-5%<br />
　　echo 从第4个字符开始，截取5个字符：<br />
　　echo %ifo:~3,5%<br />
　　echo 从倒数第14个字符开始，截取5个字符：<br />
　　echo %ifo:~-14,5%<br />
　　pause<br />
　　=========================================<br />
　　当然，上面的例子只是将字符串处理的基本功能展示出来了，还看不出字符串处理具体有什么用处。下面这个例子是对时间进行处理。<br />
　　=========================================<br />
　　@echo off<br />
　　echo 当前时间是：%time% 即 %time:~0,2%点%time:~3,2%分%time:~6,2%秒%time:~9,2%厘秒<br />
　　pause<br />
　　=========================================</p>

<p><br />
━━━━━━━━━━━━━━━━━━━━━━━━━━<br />
3、扩充字符串<br />
━━━━━━━━━━━━━━━━━━━━━━━━━━<br />
&ldquo;扩充&rdquo;这个词汇来自于微软自己的翻译，意思就是对表示文件路径的字符串进行特殊的处理，具体功能罗列如下：<br />
　　=========================================<br />
　　~I - 删除任何引号(&quot;)，扩充 %I<br />
　　%~fI - 将 %I 扩充到一个完全合格的路径名<br />
　　%~dI - 仅将 %I 扩充到一个驱动器号<br />
　　%~pI - 仅将 %I 扩充到一个路径<br />
　　%~nI - 仅将 %I 扩充到一个文件名<br />
　　%~xI - 仅将 %I 扩充到一个文件扩展名<br />
　　%~sI - 扩充的路径只含有短名<br />
　　%~aI - 将 %I 扩充到文件的文件属性<br />
　　%~tI - 将 %I 扩充到文件的日期/时间<br />
　　%~zI - 将 %I 扩充到文件的大小<br />
　　%~$PATH:I - 查找列在路径环境变量的目录，并将 %I 扩充<br />
　　到找到的第一个完全合格的名称。如果环境变量名<br />
　　未被定义，或者没有找到文件，此组合键会扩充到<br />
　　空字符串<br />
　　可以组合修饰符来得到多重结果:<br />
　　%~dpI - 仅将 %I 扩充到一个驱动器号和路径<br />
　　%~nxI - 仅将 %I 扩充到一个文件名和扩展名<br />
　　%~fsI - 仅将 %I 扩充到一个带有短名的完整路径名<br />
　　%~dp$PATH:i - 查找列在路径环境变量的目录，并将 %I 扩充<br />
　　到找到的第一个驱动器号和路径。<br />
　　%~ftzaI - 将 %I 扩充到类似输出线路的 DIR<br />
　　=========================================<br />
　　以上内容引用于for /?帮助信息。其中的I代表变量I，不过需要说明的是，不是所有的变量都能够进行扩充的，有两个条件：1、该字符串代表一个文件路径；2、变量要用%x来表示，x可取a-z A-Z 0-9共62个字符中的任意一个。举例说明：<br />
　　=========================================<br />
　　@echo off<br />
　　echo 正在运行的这个批处理：<br />
　　echo 完全路径：%0<br />
　　echo 去掉引号：%~0<br />
　　echo 所在分区：%~d0<br />
　　echo 所处路径：%~p0<br />
　　echo 文件名：%~n0<br />
　　echo 扩展名：%~x0<br />
　　echo 文件属性：%~a0<br />
　　echo 修改时间：%~t0<br />
　　echo 文件大小：%~z0<br />
　　pause<br />
　　=========================================<br />
　　其中的%0是批处理里面的参数，代表当前运行的批处理的完全路径。类似的还有%1-%9，分别代表传递来的第1-9个参数。例子如下：<br />
　　===============================================<br />
　　@echo off<br />
　　set aa=C:\Windows\PPP\a.btx<br />
　　call :deal aaa �% &quot;c c&quot; ddd eee<br />
　　pause&gt;nul<br />
　　exit<br />
　　:deal<br />
　　echo %%0 = %0<br />
　　echo %%1 = %1<br />
　　echo %%2 = %2<br />
　　echo %%3 = %3<br />
　　echo %%4 = %4<br />
　　echo %%5 = %5<br />
　　===============================================<br />
　　其中，变量aa在之前是不可以扩充的，通过call命令并将aa作为参数传递给子函数:deal，将aa变量转换成了变量%1，即符合%x格式，从而可以进行字符串扩充。<br />
至于%x中x取a-z A-Z的形式，可以复习一下for语句，for语句里面的变量就是用%x来表示的，因而可以直接进行扩充。</p>

<p>━━━━━━━━━━━━━━━━━━━━━━━━━━<br />
4、获取字符串长度<br />
━━━━━━━━━━━━━━━━━━━━━━━━━━</p>

<p>通过循环截取字符串来获取,代码如下:</p>

<p>=========================================</p>

<p>@echo off<br />
set mystr=hello world<br />
set str=%mystr%<br />
::将&quot;号替换成空格<br />
set &quot;str=%str:&quot;= %&quot;<br />
:next<br />
if not &quot;%str%&quot;==&quot;&quot; (<br />
set /a num+=1<br />
set &quot;str=%str:~1%&quot;<br />
goto next<br />
)<br />
echo %mystr%字符串长度为:%num%<br />
pause</p>

<p>=========================================</p>

<p>运行结果:</p>

<p>hello world字符串长度为:11</p>
